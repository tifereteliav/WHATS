import React, { useState } from 'react';
import { Users, Phone, Video, MoreVertical, Heart, Send, HelpCircle, ChevronLeft, ThumbsUp, ThumbsDown, MessageCircle } from 'lucide-react';

const WhatsAppTeaser = () => {
  // 砖: 转 爪 'intro'  注  注 拽住 0 砖 注专
  const [step, setStep] = useState('intro');
  const [voted, setVoted] = useState(false);

  // 砖 爪转 专拽转
  const scenarios = [
    {
      id: 'medical',
      type: 'medical',
      title: " 1:  驻砖专 住 注 ?",
      sender: " 砖 转 ( 10)",
      message: ", 转 注 350 住专 专 砖注转 专 转拽 砖.  专 砖转  .  注砖转?  注 砖转  转.",
      responseSender: "注转 ( 转拽)",
      response: "转拽砖,  转. 转 砖转 砖转祝   转 住 注专 转拽 拽.  拽    砖转 砖转转 专拽 注,  专 砖!",
      question: " 注转?  注  拽爪注 ?",
      options: [
        { label: "住 住转 注 ", icon: <ThumbsDown className="w-6 h-6" /> },
        { label: "注  拽", icon: <ThumbsUp className="w-6 h-6" /> }
      ]
    },
    {
      id: 'emotional',
      type: 'emotional',
      title: " 2:  砖  转",
      sender: "专 ( 专)",
      message: " 驻砖 专住拽转. 专 砖注  砖转 转专 砖注转 专爪祝. 专砖 砖  爪  转 砖 砖转 .  专拽 爪  ?",
      responseSender: "拽爪转 专",
      response: "专 , 转 !   砖.    注专. 转  砖转, 转 转  转 驻砖专转. 转 注爪 拽, 住专 住转专.",
      question: " 注转 转  转 注专转 专 爪拽?",
      options: [
        { label: "住转 拽砖转,  注专", icon: <MessageCircle className="w-6 h-6" /> },
        { label: "拽 砖注转 ", icon: <Heart className="w-6 h-6" /> }
      ]
    }
  ];

  const handleVote = () => {
    setVoted(true);
  };

  const handleNext = () => {
    // 拽   注 转 注专
    if (typeof step === 'number' && step < scenarios.length - 1) {
      setStep(step + 1);
      setVoted(false);
    } else {
      setStep('finish');
    }
  };

  // 住 驻转
  if (step === 'intro') {
    return (
      <div className="flex flex-col items-center justify-center h-screen bg-gray-100 font-sans text-center p-4" dir="rtl">
        <div className="bg-white p-10 rounded-3xl shadow-2xl max-w-lg w-full border-t-8 border-[#25D366]">
          <div className="bg-green-100 w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6">
            <Users size={48} className="text-green-600" />
          </div>
          <h1 className="text-4xl font-bold text-gray-800 mb-4">住 拽爪...</h1>
          <p className="text-xl text-gray-600 mb-8 leading-relaxed">
            驻 砖转,    砖转 住爪转 转转 转 拽爪转 住驻 砖 专.
            <br/><br/>
            <strong>驻 砖 爪驻爪祝.  转 砖 注  砖拽专 砖?</strong>
          </p>
          <button 
            onClick={() => setStep(0)} 
            className="bg-[#008069] text-white text-2xl font-bold py-4 px-12 rounded-full shadow-lg hover:bg-[#006a57] transition transform hover:scale-105"
          >
              转
          </button>
        </div>
      </div>
    );
  }

  // 住 住
  if (step === 'finish') {
    return (
      <div className="flex flex-col items-center justify-center h-screen bg-[#008069] text-white font-sans text-center p-4" dir="rtl">
        <div className="max-w-2xl animate-fade-in-up">
          <HelpCircle size={80} className="mx-auto mb-6 text-green-200" />
          <h1 className="text-5xl font-bold mb-8">  转?</h1>
          <p className="text-2xl mb-12 leading-relaxed opacity-90">
            爪注转 驻 转砖转  砖.
            <br />
             专 转 拽 注 专驻 拽?
            <br />
             "拽 专" 转 注?
            <br />
            <span className="font-bold text-yellow-300 mt-4 block text-3xl">  转 转砖转.</span>
          </p>
          <div className="text-sm opacity-60">专爪 转 注转</div>
        </div>
      </div>
    );
  }

  // 砖 转专砖  (专拽  step  住驻专)
  const activeScenarioIndex = typeof step === 'number' ? step : 0;
  const activeScenario = scenarios[activeScenarioIndex];

  return (
    <div className="flex flex-col h-screen bg-[#e5ddd5] font-sans" dir="rtl">
      {/* Header WhatsApp Style */}
      <div className="bg-[#008069] text-white p-3 flex items-center justify-between shadow-md z-10">
        <div className="flex items-center gap-3">
          <ChevronLeft className="w-6 h-6" />
          <div className="bg-gray-200 rounded-full p-2">
            <Users className="w-6 h-6 text-gray-500" />
          </div>
          <div className="flex flex-col">
            <span className="font-bold text-lg">专 转拽 </span>
            <span className="text-xs text-green-100">专 注转...</span>
          </div>
        </div>
        <div className="flex gap-4 opacity-80">
          <Video className="w-5 h-5" />
          <Phone className="w-5 h-5" />
          <MoreVertical className="w-5 h-5" />
        </div>
      </div>

      {/* Chat Container */}
      <div className="flex-1 overflow-y-auto p-4 bg-[url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png')]">
        
        {/* Title Bubble */}
        <div className="flex justify-center mb-6 mt-2">
          <span className="bg-[#e1f3fb] text-gray-700 text-sm font-bold py-2 px-4 rounded-lg shadow-sm border border-blue-100">
            {activeScenario.title}
          </span>
        </div>

        {/* Question Message */}
        <div className="flex flex-col gap-1 max-w-[85%] md:max-w-[70%] mr-auto mb-4 animate-fade-in-right">
          <div className="bg-white rounded-tr-none rounded-xl p-4 shadow-sm relative">
            <div className="text-[#e542a3] text-sm font-bold mb-1">{activeScenario.sender}</div>
            <div className="text-gray-800 text-lg leading-snug">
              {activeScenario.message}
            </div>
            <div className="text-xs text-gray-400 text-left mt-2">21:14</div>
          </div>
        </div>

        {/* Answer Message */}
        <div className="flex flex-col gap-1 max-w-[85%] md:max-w-[70%] ml-auto mb-8 animate-fade-in-left" style={{animationDelay: '0.5s'}}>
          <div className="bg-[#dcf8c6] rounded-tl-none rounded-xl p-4 shadow-sm relative">
            <div className="text-[#008069] text-sm font-bold mb-1">{activeScenario.responseSender}</div>
            <div className="text-gray-800 text-lg leading-snug">
              {activeScenario.response}
            </div>
            <div className="text-xs text-gray-500 text-right mt-2">21:16</div>
            <div className="absolute -bottom-2 -left-2 bg-white rounded-full p-1 shadow border text-xs flex gap-1">
               {activeScenario.type === 'emotional' ? 'わ ' : ''}
            </div>
          </div>
        </div>

        {/* Interaction Area (Fixed at bottom or visible) */}
        <div className="mt-8">
           {!voted ? (
             <div className="bg-white/90 backdrop-blur-sm p-6 rounded-2xl shadow-xl border border-gray-200 text-center animate-bounce-in">
               <h3 className="text-xl font-bold text-gray-800 mb-6">{activeScenario.question}</h3>
               <div className="flex gap-4 justify-center">
                 {activeScenario.options.map((opt, idx) => (
                   <button
                     key={idx}
                     onClick={handleVote}
                     className={`flex flex-col items-center gap-2 p-4 rounded-xl w-36 transition-all transform hover:scale-105 active:scale-95 shadow-md border-2 
                       ${idx === 0 ? 'bg-red-50 border-red-100 hover:border-red-300 text-red-700' : 'bg-green-50 border-green-100 hover:border-green-300 text-green-700'}`}
                   >
                     {opt.icon}
                     <span className="font-bold text-sm">{opt.label}</span>
                   </button>
                 ))}
               </div>
             </div>
           ) : (
             <div className="bg-blue-600/90 backdrop-blur-sm p-8 rounded-2xl shadow-xl text-center text-white animate-fade-in">
               <div className="mb-4 text-4xl"></div>
               <h3 className="text-2xl font-bold mb-2">爪注 拽!</h3>
               <p className="text-lg opacity-90 mb-6">
                 注 砖 注转.<br/>
                   转转 转  砖爪 拽专? 转祝 .
               </p>
               <button 
                 onClick={handleNext}
                 className="bg-white text-blue-700 font-bold py-3 px-8 rounded-full hover:bg-gray-100 transition shadow-lg flex items-center gap-2 mx-auto"
               >
                 {activeScenarioIndex < scenarios.length - 1 ? " " : "住 转 专爪"}
                 <ChevronLeft />
               </button>
             </div>
           )}
        </div>

      </div>
    </div>
  );
};

export default WhatsAppTeaser;
